# linkedin-capi-tag-template

A Google Tag Manager (GTM) tag template that can be utilized to begin streaming conversion events to LinkedIn's Conversion API endpoint.

Further documentation can be found here: https://learn.microsoft.com/en-us/linkedin/marketing/integrations/ads-reporting/conversions-api

## Tag configuration :

- apiAccessToken (required) - GTM access token generated via LinkedIn Campaign Manager _Required_
- apiVersion (required) - e.g. 202402 - should not be more than 12 months from current data _Required_
- conversionRuleUrn (required) - CAPI Conversion Rule ID defined in LinkedIn Campaign Manager _Required_
- eventId (optional) - unique id generated by advertisers to indicate each event. If you set eventID value in CAPI configuration, it'll be used as default. If you send eventID via gtag function, it'll override the eventID value in CAPI configuration. If you don't set eventID value in CAPI configuration nor send in gtag function, eventID will be absent in the CAPI payload. You should map it to a dyanmic variable to deduplicate any event instance being sent to CAPI and Insight Tags. _Optional_
- conversionValue (optional) - The monetary value for this conversion. It contains “currencyCode” in ISO format (e.g. “USD”) and the “amount” value of the conversion in decimal string. (e.g. “100.05”). Advertisers can set conversion values dynamically here or set a fix value. ie: '{"currencyCode": "USD", "amount": "50.0"}'. If you set conversionValue in CAPI configuration, it'll be used as default. If you send conversionValue via datalayer.push function, it'll override the conversionValue value in CAPI configuration. If you don't set conversionValue value in CAPI configuration nor send in via datalayer.push function, conversionValue will be absent in the CAPI payload. If you send it via datalayer.push function, you should first push them as data layer variables and forward the values as GA4 event variables (currency, value) for that event instance. _Optional_

## How to varaibles to CAPI :

- You must send at least one of the following parameters: Email Address, LinkedIn First Party Ads Tracking UUID, Axciom ID, Oracle Moat ID, or First Name and Last Name. If you send any user information (for example: Company, Title, or Country Code), you must include the First Name and Last Name parameters, regardless if you provide other identity parameters.
- LinkedIn First Party Ads Tracking UUID / li_fat_id / linkedinFirstPartyId can be sent by different ways : gtag function (user_data), or GTM web container GA4 user properties. In latter case, you don't need to add any gtag code in the website, instead you capture linkedinFirstPartyId directly in GTM web container
- email_address or sha256_email_address can be sent by gtag function (user_data). If sha256_email_address is sent, email_address will be ignored. if sha256_email_address is not sent but email-address is available, it will be normalized and hashed in the CAPI payload
- first_name, last_name can be sent by gtag function (user_data.address)
- jobTitle can be sent by gtag function (user_data)
- companyName can be sent by gtag function (user_data)
- acxiomID can be sent by gtag function (user_data)
- moatID can be sent by gtag function (user_data)
- leadID can be sent by gtag function (user_data)
